#include <Arduino.h>
#include <Ticker.h>
#include <Wire.h>
#include "DS3231.h"

/*  -----------------------------------------------------------------------  const ------------------------------------------------------------- */
/* +++++++++++++++++++++++++++++++++++++++++++++++++++  A_ pour adresse , R_ pour registre ++++++++++++++++++++++++++++++++++++++++++++++++++++ */

const uint8_t A_DS3231 = 0x68; // adresse de DS3231

/* ------------------------------------------------------------prototypes------------------------------------------------------------------- */
void action();
/* ...................................DS3231 ........................*/
// hh:mm

/*  -----------------------------------------------------------------------  objets ------------------------------------------------------------- */
Ticker mticker(action, 1000, 0, MILLIS);

/*  --------------------------------------------------------------  variable globale ------------------------------------------------------------- */
DS3231 cap_ds3231;
/*  *********************************************************************  Action **************************************************************** */
void action()
{
  uint8_t second = cap_ds3231.getSecond();
  uint8_t heure = cap_ds3231.getHour();
  uint8_t minute = cap_ds3231.getMinute();
  String Day = cap_ds3231.getStringDay();
  String Month = cap_ds3231.getStringMonth();
  uint8_t DATE = cap_ds3231.getNumber();
  Serial.printf(" HH : MM : SS : JOUR : MOIS : DATE = %d : %d : %d : %s : %s : %d\n \r", heure, minute, second, Day, Month, DATE);

  // RTC3231_getStringDay();
}

/* ________________________________________________FONCTIONS__________________________________________________*/

// String RTC3231_getStringTime() // hh:mm
// {
// }

/*  ____________________________________________  SETUP _____________________________________________________ */
void setup()
{
  Wire.begin();
  // cap_ds3231.setTime(14, 15, 0);
  // RTC3231_setDate(5, 1, 2);
  Serial.begin(115200);

  Serial.println("pret");
  mticker.start();
  bool res = cap_ds3231.begin(A_DS3231);
}

/*  ____________________________________________  LOOP ______________________________________________________ */
void loop()
{
  mticker.update();
}
